version: "3"

services:

  # TerraMA2 Web Application
  webapp:
    image: "terrama2.dpi.inpe.br:443/terrama2-webapp:4.0.0-rc4"
    ports:
      - "127.0.0.1:36000:36000"
    volumes:
      - "${TERRAMA2_DATA_DIR}:/data"
      - "${CONFIG_DIR}/${CONTEXT}_webapp.json:/opt/terrama2/4.0.0/webapp/config/instances/default.json"
    networks:
        - net

  # TerraMA2 Web Monitor
  webmonitor:
    image: "terrama2.dpi.inpe.br:443/terrama2-webmonitor:4.0.0-rc4"
    ports:
      - "127.0.0.1:36001:36001"
    volumes:
      - "${TERRAMA2_DATA_DIR}:/data"
      - "${CONFIG_DIR}/${CONTEXT}_webmonitor.json:/opt/terrama2/4.0.0/webmonitor/config/instances/default.json"
    networks:
        - net

  # TerraMA2 Collector Service using TerraMA2 Base
  collector:
    image: "terrama2.dpi.inpe.br:443/terrama2:4.0.0-rc4"
    entrypoint: 
      - /usr/local/bin/start_terrama2_service.sh
      - COLLECTOR
      - "6543"
    volumes:
      - "${TERRAMA2_DATA_DIR}:/data"
    tty: true
    networks:
        - net

  # TerraMA2 Analysis Service using TerraMA2 Base
  analysis:
    image: "terrama2.dpi.inpe.br:443/terrama2:4.0.0-rc4"
    entrypoint: 
      - /usr/local/bin/start_terrama2_service.sh
      - ANALYSIS
      - "6544"
    volumes:
      - "${TERRAMA2_DATA_DIR}:/data"
    tty: true
    networks:
        - net

  # TerraMA2 View Service using TerraMA2 Base
  view:
    image: "terrama2.dpi.inpe.br:443/terrama2:4.0.0-rc4"
    entrypoint: 
      - /usr/local/bin/start_terrama2_service.sh
      - VIEW
      - "6545"
    volumes:
      - "${TERRAMA2_DATA_DIR}:/data"
    tty: true
    networks:
        - net

  # TerraMA2 Alert Service using TerraMA2 Base
  alert:
    image: "terrama2.dpi.inpe.br:443/terrama2:4.0.0-rc4"
    entrypoint: 
      - /usr/local/bin/start_terrama2_service.sh
      - ALERT
      - "6546"
    volumes:
      - "${TERRAMA2_DATA_DIR}:/data"
    tty: true
    networks:
        - net

networks:

    net:
